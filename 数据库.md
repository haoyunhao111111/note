# 数据库

> 关系型数据库(MySQL)          非关系型数据库(redis)          数据仓库

## DCL:数据控制语言   

> (Datebase Controll Language)数据控制语言

### 访问控制权限

> MySQL实现了复杂的访问控制和权限系统，允许你创建的

### 命令行链接方式

```mysql
mysql -u 用户名 -p 密码 -h 服务器IP地址 -P服务器端MySQL端口号  -D 数据库名
```

### 默认表

> mysql安装程序自动创建一个名为mysql的数据库

- user：包含用户账号和全局权限列
- db:用户对于数据库的访问权限
- table_priv和columns_priv:表级和列级权限
- procs_priv:包含储存函数

### 创建账户：

```mysql
create user user_account IDENTIFIED  by password;

create user 'hyh'@'localhost' identified by '123123';
```

user_account->username@hostname



### 通配符%

> 指定域名下任何地址都可以访问到

```mysql
create user username@'%.alibaba.com' identified by password;

create user 'hyh'@'%.alibaba.com' identified by '123123';
```



### 省略主机名

```mysql
create user 'hyh1' identified by '123123';
```



### 删除账户

```mysql
drop user username@hostname,[username]
drop user 'hyh'@'localhost';
```



### 查看用户权限

```mysql
show grants for username@hastname

show grants for 'hyh'@'localhost';
```



### 设置权限

```mysql
grant privilege all on privilege_level(作用于表)
to user 'username'@hostname  
[require tsl_option]  (链接方式)
[with [grant_option | resource_option]]  （是否允许其他用户更改权限）
```



### 允许远程链接

```mysql
grant all privileges on *.* to 'root'@'%' identified by 'mysql' with grant opion;
flush privileges;（刷新）
```



### 撤销权限（revoke）

```mysql
revoke privilege_type 权限
on 表
from user 
```



### 修改密码

- 首先登陆mysql

```mysql
set password for username@localhost =password('新密码')
```

- update编辑user

```mysql
update user set password=password("123") where user='root'
```



- 用mysqladmin

```mysql
mysqladmin -u用户名 -p旧密码 password 新密码
```

- 忘记root密码或初始化密码(以window为例)

  - 关闭正在运行的mysql服务器
  - 打开DOS窗口，转到mysql/bin目录
  - 输入

  ```mysql
  mysqld --skip-grant-tables
  ```

  - 再开一个DOS窗口
  - 输入mysql回车
  - 连接权限数据库：use mysql
  - 改密码
  - 刷新权限
  - 退出
  - 注销系统

### 数据库备份

#### mysqldump命令

```python
mysqldump -u[username] -p[password] [datebase_name] > [dump_file.sql]
```

- username:有效的mysql用户名
- password：密码
- datebase_name：要备份的数据库名称
- dump_file.sql:要生成的备份文件

#### 仅备份数据库结构

```mysql
mysqldump -u[username] -p[password] --no-date [datebase_name] > [dump_file.sql]
```

#### 仅备份数据库数据

```mysql
mysqldump -u[username] -p[password] --no-create-info [datebase_name] > [dump_file.sql]
```

#### 导出多个数据库

```mysql
mysqldump -u[username] -p[password] --all-datebase > [dump_file.sql]
```

### 查看列

```mysql
show columns from teacher;  查看某个表的列
show columns from teacher like field;  查看某一表的某一列
show columns from teacher where field='name' 查看某一表的某一列
```

### 查询用户信息

- 所有用户

```mysql
select user from user;
```

- 当前用户

```mysql
select user();
```

- 当前登录的用户

  ```mysql
  select user,host,db,command from information_schema.processlist;
  ```

### 数据库维护

> 数据库提供了几个语句，可以有效的维护数据库表

#### 分析表语句

```mysql
analyze table 表名
```

#### 优化表语句

```mysql
optimize table 表名
```

#### 检查表语句

```mysql
check table 表名
```

#### 修复表语句(尝试)

```mysql
repair table 表名
```





## DDL:数据库定义语言 

> （Date Definition Language）数据库定义语言

## DML:数据库操作语言 

> （Date Manipulation Language）数据库操作语言，insert,update,delete

## DQL:数据查询语言 

>  (Date Query Langeage)   数据查询语言   select

## TCL：事务控制语言  

>  (Transaction Controll Language)  事务控制语言

## 数据库锁

## 主从配置

## 数据库优化

## MySQL操作

```mysql
#简单的数据库操作

show databases;   #查看数据库
create datebase  demo;   #创建名为demo的数据库
use demo;            #使用demo数据库
show tables;        #查看demo中的表
create table stu (
    id int(10) auto_increment primary key,   #表头名 数据类型  自增  主键
    name  varchar(10),
    age varchar(10),
    sex varchar(10))default charset=utf8;    #指定字符编码类型
desc stu;    #查看数据表的结构
insert into sut(name,age,sex) values("张三","20","男")   #插入数据
update stu set sex="女" where id=1;   #修改数据
delete from stu where id=1;    #删除数据
drop table stu     #删除表
drop database demo   #删除数据库
```

```mysql
# pymysql批量上传数据
cur.executemany("insert into phase(jname,jcon,kid) vaues(&s,%s,%s)",(1,2,3),(1,2,3))
```

